<!DOCTYPE html>
<html>

  <head>
    <title>My App</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  </head>

  <body>
    <h1>HW</h1>
    <button id="authenticate">Click here to try a fetch</button>
    <div id="users">Protected endpoint data</div>
    <div id="payload"></div>
    <div id="open">Open endpoint data</div>
    <div id="payload-open"></div>
  </body>

  <script type="module">

    import { useOAuth2 } from './oauth2.js';

    const { controlled_fetch } = useOAuth2([{
      origin: "https://data.site.test",
      client_id: "surveyor",
      authorization_endpoint: "https://auth.site.test/oauth/authorize",
      token_endpoint: "https://auth.site.test/oauth/token",
      redirect_uri: "https://surveyor.site.test/index.html",
      requested_scopes: ""
    }]);

    document
  .getElementById("authenticate")
  .addEventListener("click", async () => {
    console.dir(await controlled_fetch("https://data.site.test/_site/users", {}))
    // "https://swapi.dev/api/people/1/"
  });

  </script>

</html>
